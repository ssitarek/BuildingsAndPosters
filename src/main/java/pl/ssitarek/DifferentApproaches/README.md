Here you have other solutions.
Both of them give proper result, but are not efficient enough to pass all tests.